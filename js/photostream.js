
var back = [
    'back-2012-09-05-17-38.jpg',
    'back-2012-09-05-17-40.jpg',
    'back-2012-09-05-17-44.jpg',
    'back-2012-09-05-17-45.jpg',
    'back-2012-09-05-17-47.jpg',
    'back-2012-09-05-17-49.jpg',
    'back-2012-09-05-17-50.jpg',
    'back-2012-09-05-17-52.jpg',
    'back-2012-09-05-17-54.jpg',
    'back-2012-09-05-17-55.jpg',
    'back-2012-09-05-17-57.jpg',
    'back-2012-09-05-17-59.jpg',
    'back-2012-09-05-18-02.jpg',
    'back-2012-09-05-18-04.jpg',
    'back-2012-09-05-18-05.jpg',
    'back-2012-09-05-18-07.jpg',
    'back-2012-09-05-18-09.jpg',
    'back-2012-09-05-18-10.jpg',
    'back-2012-09-05-18-12.jpg',
    'back-2012-09-05-18-14.jpg',
    'back-2012-09-05-18-15.jpg',
    'back-2012-09-05-18-17.jpg',
    'back-2012-09-05-18-19.jpg',
    'back-2012-09-05-18-20.jpg',
    'back-2012-09-05-18-22.jpg',
    'back-2012-09-05-18-23.jpg',
    'back-2012-09-05-18-25.jpg',
    'back-2012-09-05-18-27.jpg',
    'back-2012-09-05-18-28.jpg',
    'back-2012-09-05-18-30.jpg',
    'back-2012-09-05-18-32.jpg',
    'back-2012-09-05-18-33.jpg',
    'back-2012-09-05-18-35.jpg',
    'back-2012-09-05-18-37.jpg',
    'back-2012-09-05-18-38.jpg',
    'back-2012-09-05-18-40.jpg',
    'back-2012-09-05-18-42.jpg',
    'back-2012-09-05-18-43.jpg',
    'back-2012-09-05-18-45.jpg',
    'back-2012-09-05-18-47.jpg',
    'back-2012-09-05-18-48.jpg',
    'back-2012-09-05-18-50.jpg',
    'back-2012-09-05-18-52.jpg',
    'back-2012-09-05-18-53.jpg',
    'back-2012-09-05-18-55.jpg',
    'back-2012-09-05-18-57.jpg',
    'back-2012-09-05-18-58.jpg',
    'back-2012-09-05-19-00.jpg',
    'back-2012-09-05-19-02.jpg',
    'back-2012-09-05-19-03.jpg',
    'back-2012-09-05-19-05.jpg',
    'back-2012-09-05-19-07.jpg',
    'back-2012-09-05-19-08.jpg',
    'back-2012-09-05-19-10.jpg',
    'back-2012-09-05-19-12.jpg',
    'back-2012-09-05-19-13.jpg',
    'back-2012-09-05-19-15.jpg',
    'back-2012-09-05-19-17.jpg',
    'back-2012-09-05-19-18.jpg',
    'back-2012-09-05-19-20.jpg',
    'back-2012-09-05-19-22.jpg',
    'back-2012-09-05-19-23.jpg',
    'back-2012-09-05-19-25.jpg',
    'back-2012-09-05-19-27.jpg',
    'back-2012-09-05-19-28.jpg',
    'back-2012-09-05-19-30.jpg',
    'back-2012-09-05-19-32.jpg',
    'back-2012-09-05-19-33.jpg',
    'back-2012-09-05-19-35.jpg',
    'back-2012-09-05-19-37.jpg',
    'back-2012-09-05-19-38.jpg',
    'back-2012-09-05-19-40.jpg',
    'back-2012-09-05-19-42.jpg',
    'back-2012-09-05-19-43.jpg',
    'back-2012-09-05-19-45.jpg',
    'back-2012-09-05-19-47.jpg',
    'back-2012-09-05-19-48.jpg',
    'back-2012-09-05-19-50.jpg',
    'back-2012-09-05-19-52.jpg',
    'back-2012-09-05-19-53.jpg',
    'back-2012-09-05-19-55.jpg',
    'back-2012-09-05-19-57.jpg',
    'back-2012-09-05-19-58.jpg',
    'back-2012-09-05-20-00.jpg',
    'back-2012-09-05-20-02.jpg',
    'back-2012-09-05-20-03.jpg',
    'back-2012-09-05-20-05.jpg',
    'back-2012-09-05-20-07.jpg',
    'back-2012-09-05-20-08.jpg',
    'back-2012-09-05-20-10.jpg',
    'back-2012-09-05-20-12.jpg',
    'back-2012-09-05-20-13.jpg',
    'back-2012-09-05-20-18.jpg',
    'back-2012-09-05-20-19.jpg',
    'back-2012-09-05-20-21.jpg',
    'back-2012-09-05-20-23.jpg',
    'back-2012-09-05-20-24.jpg',
    'back-2012-09-05-20-26.jpg'
    //'back-2012-09-05-20-28.jpg',
    //'back-2012-09-05-20-33.jpg',
    //'back-2012-09-05-20-34.jpg',
    //'back-2012-09-05-20-36.jpg',
    //'back-2012-09-05-20-38.jpg',
    //'back-2012-09-05-20-40.jpg',
    //'back-2012-09-05-20-41.jpg'
];

var front = [
    'front-2012-09-05-17-38.jpg',
    'front-2012-09-05-17-40.jpg',
    'front-2012-09-05-17-41.jpg',
    'front-2012-09-05-17-44.jpg',
    'front-2012-09-05-17-45.jpg',
    'front-2012-09-05-17-47.jpg',
    'front-2012-09-05-17-49.jpg',
    'front-2012-09-05-17-50.jpg',
    'front-2012-09-05-17-52.jpg',
    'front-2012-09-05-17-54.jpg',
    'front-2012-09-05-17-55.jpg',
    'front-2012-09-05-17-57.jpg',
    'front-2012-09-05-17-59.jpg',
    'front-2012-09-05-18-02.jpg',
    'front-2012-09-05-18-04.jpg',
    'front-2012-09-05-18-05.jpg',
    'front-2012-09-05-18-07.jpg',
    'front-2012-09-05-18-09.jpg',
    'front-2012-09-05-18-10.jpg',
    'front-2012-09-05-18-12.jpg',
    'front-2012-09-05-18-14.jpg',
    'front-2012-09-05-18-15.jpg',
    'front-2012-09-05-18-17.jpg',
    'front-2012-09-05-18-19.jpg',
    'front-2012-09-05-18-20.jpg',
    'front-2012-09-05-18-22.jpg',
    'front-2012-09-05-18-23.jpg',
    'front-2012-09-05-18-25.jpg',
    'front-2012-09-05-18-27.jpg',
    'front-2012-09-05-18-28.jpg',
    'front-2012-09-05-18-30.jpg',
    'front-2012-09-05-18-32.jpg',
    'front-2012-09-05-18-33.jpg',
    'front-2012-09-05-18-35.jpg',
    'front-2012-09-05-18-37.jpg',
    'front-2012-09-05-18-38.jpg',
    'front-2012-09-05-18-40.jpg',
    'front-2012-09-05-18-42.jpg',
    'front-2012-09-05-18-43.jpg',
    'front-2012-09-05-18-45.jpg',
    'front-2012-09-05-18-47.jpg',
    'front-2012-09-05-18-48.jpg',
    'front-2012-09-05-18-50.jpg',
    'front-2012-09-05-18-52.jpg',
    'front-2012-09-05-18-53.jpg',
    'front-2012-09-05-18-55.jpg',
    'front-2012-09-05-18-57.jpg',
    'front-2012-09-05-18-58.jpg',
    'front-2012-09-05-19-00.jpg',
    'front-2012-09-05-19-02.jpg',
    'front-2012-09-05-19-03.jpg',
    'front-2012-09-05-19-05.jpg',
    'front-2012-09-05-19-07.jpg',
    'front-2012-09-05-19-08.jpg',
    'front-2012-09-05-19-10.jpg',
    'front-2012-09-05-19-12.jpg',
    'front-2012-09-05-19-13.jpg',
    'front-2012-09-05-19-15.jpg',
    'front-2012-09-05-19-17.jpg',
    'front-2012-09-05-19-18.jpg',
    'front-2012-09-05-19-20.jpg',
    'front-2012-09-05-19-22.jpg',
    'front-2012-09-05-19-23.jpg',
    'front-2012-09-05-19-25.jpg',
    'front-2012-09-05-19-27.jpg',
    'front-2012-09-05-19-28.jpg',
    'front-2012-09-05-19-30.jpg',
    'front-2012-09-05-19-32.jpg',
    'front-2012-09-05-19-33.jpg',
    'front-2012-09-05-19-35.jpg',
    'front-2012-09-05-19-37.jpg',
    'front-2012-09-05-19-38.jpg',
    'front-2012-09-05-19-40.jpg',
    'front-2012-09-05-19-42.jpg',
    'front-2012-09-05-19-43.jpg',
    'front-2012-09-05-19-45.jpg',
    'front-2012-09-05-19-47.jpg',
    'front-2012-09-05-19-48.jpg',
    'front-2012-09-05-19-50.jpg',
    'front-2012-09-05-19-52.jpg',
    'front-2012-09-05-19-53.jpg',
    'front-2012-09-05-19-55.jpg',
    'front-2012-09-05-19-57.jpg',
    'front-2012-09-05-19-58.jpg',
    'front-2012-09-05-20-00.jpg',
    'front-2012-09-05-20-02.jpg',
    'front-2012-09-05-20-03.jpg',
    'front-2012-09-05-20-05.jpg',
    'front-2012-09-05-20-07.jpg',
    'front-2012-09-05-20-08.jpg',
    'front-2012-09-05-20-10.jpg',
    'front-2012-09-05-20-12.jpg',
    'front-2012-09-05-20-13.jpg',
    'front-2012-09-05-20-16.jpg',
    'front-2012-09-05-20-18.jpg',
    'front-2012-09-05-20-19.jpg',
    'front-2012-09-05-20-21.jpg',
    'front-2012-09-05-20-23.jpg',
    'front-2012-09-05-20-24.jpg',
    'front-2012-09-05-20-26.jpg'
];

$(function() {

    var container = $('#photostream').addClass('loading');
    var frontDisplay = $('<img></img>').appendTo(container);
    var backDisplay = $('<img></img>').appendTo(container);

    function imageUrl(name) {
        return '/img/photostream/' + name;
    }

    function show(images, display) {
        var index = 0;
        function rotate() {
            display.attr('src', imageUrl(images[index]));
            index = index + 1 < images.length
                ? index + 1
                : 0;
        }
        setInterval(rotate, 1000);
    }

    function showStreams() {
        show(front, frontDisplay);
        show(back, backDisplay);
        container.removeClass('loading');
    }

    function fireAfter(total, handler) {
        var counter = 0;
        return function() {
            if (++counter == total) {
                handler();
            }
        };
    }

    function loadImages(images, onLoad) {
        var loaded = fireAfter(images.length, onLoad);
        $.each(images, function(i, name) {
            var img = new Image();
            img.onload = loaded;
            img.src = imageUrl(name);
        });
    }

    loadImages(
        [].concat(front, back),
        showStreams
    );

});
